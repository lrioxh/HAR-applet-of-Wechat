//index.js
const app = getApp()
var that
const db = wx.cloud.database();
var summarize = [[[-1.07155501717007, 1.004055589070436], [-1.0662179251706574, 1.02561895009847], [-1.0637412184644175, 0.999993296326898], [-1.083443186585239, 1.030646174965967], [-1.1124876107294428, 1.0533729989901026], [-1.116801532601022, 1.02901002380514], [-1.1402084257264258, 1.056951124272118], [-1.1643136490483659, 1.0367118965801625], [-1.1523239620077281, 1.0055564443545792], [-1.176997617423787, 1.0299199886099248], [-1.1780207787237873, 1.0612646210340901], [-1.1441569367218447, 1.0658849240252848], [-1.1362801992602773, 1.0532300147321283], [-1.1396278104531752, 1.0403962969609062], [-1.1305756601426056, 1.030058425042954], [-1.122873528728309, 1.0111014120754906], [-1.0834025818838786, 0.9948336212332425], [-1.0856133535764796, 1.0192540822791298], [-1.078132494100196, 0.992315222678731], [-1.0748843563389097, 1.0031889358976585], [-1.0660879996731498, 1.0256772168084125], [-1.0612421841202777, 1.001484727965755], [-1.0804224204571948, 1.0333876675543785], [-1.107861047563285, 1.058021225894502], [-1.1118034639127425, 1.034275848489693], [-1.1360366016752639, 1.0615201996914925], [-1.1608178430726215, 1.040834337916342], [-1.147857775493383, 1.0099990071726754], [-1.1732175995485257, 1.0335355760661302], [-1.173909857360078, 1.0645665641151325], [-1.1407748158721223, 1.0676117691074782], [-1.1346358303612067, 1.053675828035024], [-1.1403687906459417, 1.0403096374281295], [-1.1341567294261719, 1.0305175510550961], [-1.1264931682785342, 1.0130164786284348], [-1.0910620919144634, 1.0038914945146904], [-1.0940280544563685, 1.0324560889392445], [-1.085002299161407, 1.0040819863038644], [1.4124483738915394, 0.7823404821856105], [1.4171947119283979, 0.7799544878933895], [1.4120058136344966, 0.7982065922513204], [1.4241132378199344, 0.8132023772824982], [1.4528287901085313, 0.8188789616626061], [1.4648509480816834, 0.8285766178330428], [1.4455265764589027, 0.8075238873187143], [1.4553501475286685, 0.802016136213661], [1.4536022464981524, 0.7881527280217783], [1.4595483706916792, 0.783175783608413], [1.4531251912979977, 0.7916646000598183], [1.4401062389626562, 0.7891453453107835], [1.4331308745806721, 0.8026035904135291], [1.4365271975175808, 0.8035249970568801], [1.4269025738714105, 0.7964891458203333], [1.4185995195629233, 0.7897054087687544], [1.4154427484056706, 0.7708140668875229], [1.411944903307042, 0.7624316851398775], [1.4206762980606595, 0.7740153132070481], [1.4199089347305944, 0.7813359608145236], [1.42279571594702, 0.7783746716395092], [1.4144906373220985, 0.796965429262884], [1.426849792127387, 0.8108387157977329], [1.4544873691590157, 0.8169696972257556], [1.4681234444980904, 0.8244170948224898], [1.4495908060442593, 0.802077256931115], [1.4599076878847712, 0.7959735264551953], [1.4613206287435556, 0.7795754302834387], [1.4684787138791409, 0.7754421133526381], [1.4655736708615006, 0.7844499724611737], [1.4539656268918129, 0.7867463279724395], [1.4482671862006409, 0.8045213887170104], [1.455821123037298, 0.8123669441530568], [1.4462086799538743, 0.8069942654652414], [1.4372864495647155, 0.8010248480574275], [1.4313098907596984, 0.7830101389193005], [1.42056464315471, 0.7649035776319681], [1.4268233947834725, 0.7745258509257356], [0.03759820868213803, 0.8780719258691759], [0.06217847456682032, 0.8346202652447767], [0.07439552427474726, 0.8636153161130277], [0.09770901882389592, 0.9000831706874413], [0.08521384835022233, 0.8558186668827007], [0.08514685626668926, 0.8197028536357195], [0.08058931527128892, 0.8185701943031877], [0.06494345027022064, 0.8198923088307525], [0.04147161157620218, 0.8243374216530532], [0.024745741549295264, 0.8550332403317074], [0.026282515015721448, 0.8614846858149063], [0.0034440616474689626, 0.8712712223063445], [-0.024621859287558976, 0.8683706093904667], [-0.01914672289927632, 0.8680350303711136], [-0.03300407401017719, 0.8476544135297247], [-0.0470705366677652, 0.8465642339482392], [-0.030858276111973545, 0.8723367354456288], [-0.007638168881323694, 0.8668665755130399], [0.00578475158397203, 0.8561452526896158], [0.0321393108500515, 0.8810375939537363], [0.057275819907880436, 0.8373754338287585], [0.07147626241006083, 0.8648486132157603], [0.09564645271906155, 0.9006899341428873], [0.08057713484139008, 0.8562515736748704], [0.08024826179533162, 0.8197555323030533], [0.07358755310340681, 0.8171721686104348], [0.05840251737242659, 0.8182450665614158], [0.034973309953476035, 0.8224036318975365], [0.02147324500660712, 0.8533488945983335], [0.0254176985965726, 0.8611086013237195], [0.006893174834612321, 0.8737440216445816], [-0.020127251333856986, 0.8716128649854588], [-0.005254853722023762, 0.8854135897561762], [-0.016517755701759104, 0.870256039428779], [-0.029611807790095524, 0.8696243787622752], [-0.012544881536672681, 0.8944310672927813], [0.00498692833688268, 0.872667932493694], [0.012528693103192027, 0.8564382941447062], [-0.4052866857688306, 3.6851573579519563], [-0.3851876429803038, 3.7026260026998643], [-0.4469511346828382, 3.6646730463850927], [-0.5412108329266815, 3.7881247372308873], [-0.6264185558815124, 3.670000484357744], [-0.6437049206598835, 3.692118626878961], [-0.7713042155097601, 3.668605735087382], [-0.7604002975621971, 3.5396357777824865], [-0.764713991559663, 3.542765098543683], [-0.6183558119681932, 3.444050691598988], [-0.7358009975592968, 3.477596763608883], [-0.7507520837677737, 3.546516511804326], [-0.77520686481148, 3.8014951559059407], [-0.7401959813373574, 3.7496119355340634], [-0.6724281914895243, 3.598495174232394], [-0.5939552397230419, 3.5730715811806806], [-0.5443952758875439, 3.5350663121880777], [-0.42654808313917303, 3.4661274294651965], [-0.38244910465979604, 3.529552473747214], [-0.4139864423264891, 3.685404131206797], [-0.3907602980133083, 3.7024919068580466], [-0.4533820106347991, 3.6626486679327317], [-0.5515082169766143, 3.7840925958164937], [-0.6460479552841792, 3.657629266200165], [-0.6609448559771655, 3.6788864768100042], [-0.7788281926601115, 3.6612945427110044], [-0.7651418349311009, 3.5346565396077256], [-0.7533435711037304, 3.5576220148686026], [-0.6019896433641345, 3.464032862112943], [-0.7024285155585257, 3.5092658075307406], [-0.7164716967460463, 3.577792010001815], [-0.7327327323382942, 3.829535857085051], [-0.7095427036411681, 3.763375946042973], [-0.666179990514292, 3.5987547050109217], [-0.5869798100537668, 3.5731236896265903], [-0.5290409066098727, 3.532780488502002], [-0.4006915392385701, 3.4538626078330723], [-0.35367912815299707, 3.5143543028619186], [3.055840355865026, 1.3412697138925962], [2.962443129238436, 1.3172441268326645], [3.0088683376877996, 1.331018500138389], [3.069215027457577, 1.3169330623964404], [3.0276994993120936, 1.2248061853106957], [3.067195713267488, 1.2485431075868927], [3.068609510690479, 1.2133244713250069], [3.1250081300711794, 1.230503480711808], [3.057303576651266, 1.2805863299994669], [3.0264392760345493, 1.3105603280455325], [2.9806644963258404, 1.2851770218820493], [2.9296184651932475, 1.279236508808104], [2.888143837988629, 1.2668359433011864], [2.9039802618198474, 1.2489480662264807], [2.8941604035385584, 1.176274826662886], [2.9472210190053714, 1.2792161997954956], [3.0298811826160397, 1.2574880616962947], [3.0662471527012727, 1.3660935359953996], [3.0163122750187323, 1.3572234328723636], [3.0386892425811896, 1.3686538433726332], [2.925548432237011, 1.3417572312840031], [2.967244393997273, 1.3510803366397384], [3.0346375244148707, 1.3245640542400186], [3.0202778946545163, 1.2165826839300473], [3.066007497704635, 1.2476494453422937], [3.0690790154671266, 1.21364861913157], [3.1286666005321035, 1.2322390932379523], [3.06096204711219, 1.282448961855191], [3.030097746495473, 1.3124671908597434], [2.986039408814099, 1.2886478621798412], [2.9423785891573306, 1.291400140087101], [2.901098192274823, 1.2798430295140264], [2.9419223783632455, 1.3112816932444655], [2.9340086725808807, 1.2421358702925278], [2.9870692880476937, 1.3384349994469726], [3.0612692067683756, 1.2885516333773956], [3.066765652495926, 1.3658209952608367], [3.02312740241572, 1.3505753667188491], [-0.15579207108940107, 4.165534368144296], [-0.09649807989786742, 4.157939630945576], [0.007740171152656361, 4.1719408739170865], [-0.02910908431572429, 4.105610940532684], [-0.010354716697030985, 4.111287717247065], [0.028089052918603866, 4.1383703865576305], [-0.03471010512972282, 4.179320139954793], [-0.0535864396873167, 4.178829431856388], [-0.12035145566372549, 4.294413464099862], [-0.2501188698935054, 4.381885393501922], [-0.2866790722108493, 4.333430945328182], [-0.31960763195056024, 4.305988316236738], [-0.4249293304727239, 4.245428988392147], [-0.47615154419031186, 4.211993774208947], [-0.48990564704951595, 4.169221227524768], [-0.5188547894200783, 4.206200333398807], [-0.49308560157226305, 4.260116709441356], [-0.42461764938750507, 4.298217938461724], [-0.2822298735885297, 4.264445031572431], [-0.17383214218889254, 4.187575094251356], [-0.11120012520922948, 4.1754606538508865], [-0.0012163137227801954, 4.182086876742143], [-0.04011626800490638, 4.115836889661586], [-0.01716565257416825, 4.115546680339685], [0.017447744764513887, 4.142731149387349], [-0.04551402435211812, 4.181468648977289], [-0.06255196022280192, 4.178749055743179], [-0.13209490042369246, 4.292778433414326], [-0.2580409747532616, 4.379759480904389], [-0.28681847434175217, 4.333355536144995], [-0.31359494976320507, 4.310415241702019], [-0.41297234575879777, 4.258103023037416], [-0.460883634606913, 4.230847339277575], [-0.4753649666652841, 4.187561819058186], [-0.5020782175805356, 4.227891516387247], [-0.47379705158330626, 4.285282634238444], [-0.4061511848437584, 4.322017622940419], [-0.263763409044783, 4.2878137283680395]], [[-1.1943545383851855, 1.9944506299821185], [-1.1405910156787402, 2.0586598069706348], [-1.2101783600876168, 1.9787728139333334], [-1.1760907827185527, 1.8565949133111714], [-1.148737647360371, 1.7699190967106968], [-1.0245850651014237, 1.859902169452274], [-1.053647888163405, 2.012574285279165], [-1.0244594996329397, 2.0138519642128747], [-1.0135870218697576, 2.077648997446469], [-1.0910775832561475, 1.8086487814966299], [-1.1718832113528475, 1.7731171685802336], [-1.1862716817206913, 1.7763251955439263], [-1.1113272976250417, 1.9106579666536068], [-1.1087502068689754, 1.9380845834910414], [-1.0660310889924727, 1.9605040305541577], [-0.9612434217706323, 1.9232084166131584], [-1.0102391131447568, 1.8768365311018547], [-1.0579346898162076, 1.8738308665127181], [-1.147541835303268, 1.9021832673187393], [-1.1959502499009813, 1.9943815819867556], [-1.1434153875396136, 2.0581556444336333], [-1.2152185692271638, 1.9772897380773031], [-1.1836095620397358, 1.85357679260611], [-1.15731121924135, 1.765832281419706], [-1.031920317680605, 1.8565922250393123], [-1.055680199477431, 2.0113655943696913], [-1.0005006341999698, 2.0466423523764696], [-0.9884110878732416, 2.110004962148985], [-1.0652486823288905, 1.8471952936249096], [-1.1788842528776806, 1.7705103481100648], [-1.1907246065356079, 1.775037016302759], [-1.1132340386750237, 1.9104176944458926], [-1.108309743925929, 1.9381012545882195], [-1.0624011334392331, 1.960158028668312], [-0.9544317020223506, 1.9214615879495491], [-0.9966388540868196, 1.8705120258941088], [-1.040215717117873, 1.8639431621265352], [-1.1295156977590053, 1.8933161095905642], [0.5469157423377188, 1.218087822234231], [0.531839549661644, 1.2423491325134661], [0.5076025034931879, 1.2113951932187252], [0.5188014696994345, 1.1396522660002355], [0.5193597652889308, 1.1140231408083683], [0.5375616950012984, 1.155752376592595], [0.543563972798086, 1.167099329463921], [0.5375133958652676, 1.1965146210776914], [0.5295754100736831, 1.2073789869714175], [0.5498077353582748, 1.0835051806925762], [0.5290943832538512, 1.062963617559892], [0.5255185161011233, 1.0934193757281683], [0.5031978677537653, 1.158552492219303], [0.495976593675873, 1.2153993202653726], [0.5165856203004238, 1.210006981082949], [0.5402160677007369, 1.177047658950869], [0.5848824881738232, 1.117793492537082], [0.5818262910019727, 1.0946502521846708], [0.5673006688274683, 1.1510766106454784], [0.5395476488009726, 1.213493888953973], [0.5267568390455938, 1.2395077523600462], [0.5054851902889148, 1.2104662072132548], [0.5188884025931568, 1.139681338214406], [0.5216528766247774, 1.1145202560110459], [0.5398548063371451, 1.156195157408705], [0.5463439117996923, 1.1676883281731212], [0.5456503676888984, 1.2008879650539197], [0.5347044839703988, 1.2109497008798453], [0.5527383582666516, 1.0860984020407656], [0.5204126273803864, 1.0573668549055035], [0.5137032921380934, 1.0838197295099994], [0.4889214603350528, 1.1453903653104593], [0.47912695568295255, 1.1953967944703627], [0.5016523821940345, 1.1902727092864878], [0.5268804734542726, 1.1580736536056022], [0.5744137667840526, 1.1014060237757763], [0.5794095418476048, 1.0915040999357792], [0.5676039709078688, 1.151422295749144], [-0.4710481994552538, 0.9579430569043007], [-0.5083561812430308, 0.9690860630742925], [-0.4905154987749073, 0.8870335305633591], [-0.47774014561230527, 0.785771887686857], [-0.4586785340300506, 0.7376153427177529], [-0.444744066497679, 0.762226397588263], [-0.5269135849863936, 0.889156663534449], [-0.5164100912980728, 0.9195473968847083], [-0.5099171234910647, 0.8676518503881219], [-0.4287328564778363, 0.7882412989245375], [-0.41419950949268475, 0.7478267210144298], [-0.42473970610092604, 0.8110740217947427], [-0.4580970472889021, 0.9187366318010617], [-0.5065441084851984, 0.9374149155312952], [-0.5383115259145627, 0.9128460770299497], [-0.4839046965860161, 0.8047016199892454], [-0.429669804529347, 0.7768322398711734], [-0.4479335595040597, 0.8045179349739346], [-0.43748029056305604, 0.8953172628138424], [-0.4658225322059626, 0.9581159011012675], [-0.5031691510223262, 0.9697980792429653], [-0.48648371772780535, 0.8883025896710286], [-0.4745931540580181, 0.7873193072470313], [-0.4556744996497723, 0.7391472856473232], [-0.44251277425134883, 0.7633084260185543], [-0.5250126398271776, 0.8901684858368206], [-0.5170881723634891, 0.9192834592936413], [-0.5107362299271289, 0.8673117228386552], [-0.43252122375214375, 0.7860010758847364], [-0.4177850320064012, 0.7452125290254631], [-0.43221791567386036, 0.8036623769887563], [-0.4658669677615586, 0.9115010124225672], [-0.5227137328282322, 0.9126199619944578], [-0.5562603892814819, 0.881586580076902], [-0.5018535599529352, 0.7703379746832164], [-0.4472013872544912, 0.7427061968918915], [-0.4570905515321365, 0.7926738275532751], [-0.4410252442748676, 0.8926652577862192], [0.6049684314658085, 2.0104650719383375], [0.6293187862442385, 2.011202642950869], [0.5234108365651581, 1.9545292478878096], [0.49815780863930065, 2.1220374756557976], [0.6413198814937665, 2.177911574214661], [0.600592658900085, 2.2503577051194843], [0.5852431238839223, 2.1728826476201792], [0.6258328003027747, 2.188020343178535], [0.5701428936013291, 2.143162011781796], [0.6234514834359288, 2.15203444653958], [0.7599553670133313, 2.17082174434607], [0.6765967471555115, 2.116067157416986], [0.6130021045044545, 2.182407901568372], [0.5822643427959373, 2.1568679376808424], [0.47401805780828, 2.085821992089016], [0.492023995716966, 2.1100661511963463], [0.5333400926282329, 2.201318611511168], [0.6677079274950009, 2.191544004918152], [0.648898187604162, 2.1449509018919417], [0.6248659173988046, 2.0063917114469194], [0.6460053771734238, 2.00926526499027], [0.5298328798925204, 1.9551435040437815], [0.5042101899682987, 2.122584063727892], [0.6457044892914353, 2.178162167136565], [0.5998149038472723, 2.25018806785604], [0.5749444410865826, 2.1676512800349963], [0.6127057800129536, 2.180705891976091], [0.5419285341256088, 2.11368189743385], [0.5913771699453073, 2.122672009345979], [0.7272921742931489, 2.1438334122664213], [0.6441398787973148, 2.087443219614475], [0.5832446235562524, 2.15743270274055], [0.5653676353995839, 2.1478876954102533], [0.4838358266579528, 2.0857143849260487], [0.503720159762569, 2.1104843160933258], [0.5450362566738359, 2.2014981667455276], [0.6823310402312106, 2.189634255346335], [0.6601900505803285, 2.142455911270042], [0.30955539445482916, 1.370945929452103], [0.3239936766556404, 1.3651827200778464], [0.25943619957674413, 1.3287141737670531], [0.2753230366224964, 1.2746274773202158], [0.319566338833782, 1.3218518069912377], [0.23298393165968292, 1.3276969651011725], [0.22507920042676965, 1.3121779589723752], [0.2325154045979763, 1.2996226496280239], [0.22154591445841135, 1.3010030813191984], [0.22800209286111978, 1.3702422830009109], [0.24594787057609327, 1.4106260919270601], [0.30692907957540405, 1.4499249486367478], [0.27399053424596786, 1.478059162291501], [0.31998327374458313, 1.5275257181289523], [0.27277409093033883, 1.5065202190482025], [0.27502644756591066, 1.497710651010963], [0.3025189365632081, 1.3637796341055406], [0.3187704793939878, 1.2522053985337587], [0.30652007726283986, 1.3197996090447572], [0.32738444731841165, 1.379796293028122], [0.32907371203257374, 1.3647317023022856], [0.25858446085945735, 1.3289858583511545], [0.267765814062929, 1.2747305651050747], [0.28471005978363173, 1.282342522017389], [0.19798580581237407, 1.2860701900432077], [0.1865478004038015, 1.2721208660294074], [0.19756026331320284, 1.2571818831387833], [0.18659077317363792, 1.2583016961424416], [0.194813588664176, 1.329271615684093], [0.211125977998299, 1.3667166019556847], [0.26582294624418984, 1.3895408596648293], [0.22618751203821552, 1.4211190554560553], [0.25017680852643903, 1.400945790868569], [0.19870362575015715, 1.3814441910292088], [0.19968365971562302, 1.3740255651539321], [0.23604801936908776, 1.2745697297415788], [0.2826339387195936, 1.2567350559884338], [0.27878258474764506, 1.3176809130895688], [0.19691278917654867, 5.149438844117134], [0.09676897339522839, 5.087963270147357], [0.044461905655841676, 5.042207193428665], [-0.008941254488402797, 4.965359858167981], [-0.042077515063987624, 5.050044872680414], [-0.08600704702398469, 5.121961858381623], [-0.039756411866795634, 5.00413290997744], [-0.008550118009049085, 4.904459670130556], [0.07314503048696826, 4.942646704577315], [0.23417983420433536, 4.852461340363332], [0.2169948751407285, 4.987984693381126], [0.1102788143100277, 5.043171178252388], [0.05577955322880899, 5.080848216547044], [0.1319555624598457, 5.090914365655787], [0.05496715571010305, 4.929044560709172], [0.08223182539786061, 4.803752048040569], [0.08751506899153033, 4.934546328435999], [0.14519513788963517, 5.0852419868764045], [0.22543311951261374, 5.130894358202708], [0.2001800927664003, 5.1454172471219], [0.0968597685737956, 5.087855579843864], [0.03908515138731849, 5.04821508693248], [-0.015598924109531988, 4.9719399403292455], [-0.05609832526815514, 5.060631090479226], [-0.10549970397785786, 5.134990870157909], [-0.0631992858984778, 5.01782824241606], [-0.03935612973967387, 4.919860375503498], [0.06194396148766241, 4.94490425010905], [0.2268344183121958, 4.852830277182016], [0.1968660558904371, 4.98564741154115], [0.08084398724379079, 5.035735812674799], [0.0060950277313109365, 5.06461841078301], [0.07238904446844131, 5.069570945909626], [-0.011502571313852263, 4.909182081329547], [0.006903121548314248, 4.785210502782368], [0.003640643411105679, 4.918478286970728], [0.05828175219076295, 5.0733115936705735], [0.13683046896250978, 5.122052272851165]], [[-0.7319697489287575, 0.4510291027415176], [-0.7161862997073231, 0.4673850308322055], [-0.7093611888723962, 0.5021634129949301], [-0.7225942592164663, 0.5036427658149678], [-0.7352511748201856, 0.5079658513359763], [-0.734730773290282, 0.4959739557265559], [-0.7245560910207508, 0.48317121956549103], [-0.6765717500017892, 0.6005523657208857], [-0.6762165484853603, 0.5869126823423889], [-0.6768071681004146, 0.5814812217418742], [-0.7085021122971927, 0.47740925890754377], [-0.6916055771088677, 0.4981692269793626], [-0.6946267996320565, 0.5093129282722934], [-0.7083947289542392, 0.5045811747188874], [-0.7136400468438735, 0.5013989393135042], [-0.7225674167054641, 0.4924159479661937], [-0.7198043355702197, 0.4749568699781204], [-0.7173757928198782, 0.46777395061961147], [-0.7336300857814735, 0.4536724746278874], [-0.7294937113524768, 0.4491749941489222], [-0.7172911211262168, 0.46809976278587373], [-0.7116864760253772, 0.5038988623309426], [-0.7252685454381019, 0.5054527811442306], [-0.7395754650793167, 0.5110655132227013], [-0.7417045691399835, 0.5004575457648978], [-0.7371985482228599, 0.4830685222472064], [-0.716050004731093, 0.4799860986697759], [-0.714046864272577, 0.46089430852355984], [-0.7146374838876313, 0.45390792341708264], [-0.71026156587749, 0.47870009462761137], [-0.6939577105021554, 0.500064381942147], [-0.6966629739417213, 0.5109802911800407], [-0.7102863481268287, 0.5061248044172824], [-0.7138651417295352, 0.501545551486405], [-0.7227925115911258, 0.49256111877007286], [-0.7200294304558814, 0.4751086959628021], [-0.7191373114955837, 0.4691730978097956], [-0.7357199530855849, 0.4552191619921339], [1.1667574294682206, 0.5009436366839538], [1.1526694063996445, 0.48485716995463624], [1.140881900129647, 0.4807888368741249], [1.1485536964289074, 0.4823268734910421], [1.1595709323883057, 0.4829726950995279], [1.1420486754384533, 0.47885702508239225], [1.1431968603925458, 0.49617008041590127], [1.1327413249889324, 0.5096148631849556], [1.1328074126664935, 0.48703406513535186], [1.1539890003101578, 0.4763402273837444], [1.1597918945139851, 0.47177465472490215], [1.153080364239627, 0.48028700163333493], [1.1420073732733727, 0.48358366132743524], [1.1576090997149204, 0.47860766425366075], [1.169978968156823, 0.48594867163327654], [1.1676454185668765, 0.48971046632797055], [1.1397832779791848, 0.4913445013015043], [1.1381456631010975, 0.5083361490440613], [1.160549778619717, 0.509415488578017], [1.1716000561056465, 0.5004560786904589], [1.1569606556460774, 0.4848247394562095], [1.1458917994951379, 0.4813086013619306], [1.1528449456753402, 0.4823312097053205], [1.1638621816347385, 0.48287827611508183], [1.1463399246848862, 0.47892018984400636], [1.146932601543336, 0.4964302415340038], [1.1270148416274581, 0.5070795212540167], [1.123407141016475, 0.48680395886282973], [1.1437007417452747, 0.47765484240907136], [1.1579560334312504, 0.47412760440892027], [1.131712918137682, 0.5519982196366415], [1.1206399271714276, 0.5544386982906788], [1.1345358919994584, 0.5518760699984173], [1.1459434300918003, 0.5511950765631369], [1.1483678392552097, 0.5250291823331291], [1.122104074805975, 0.5092670028629077], [1.1204561335516388, 0.5192069970468157], [1.1446031820157478, 0.5153700136522941], [0.03302701580757677, 0.11084120789995945], [0.035071451865750815, 0.11197239764990709], [0.04249750196648729, 0.12223299203471952], [0.038584163552952994, 0.13750215269271499], [0.03887534026329502, 0.1435352072602649], [0.033613500476349145, 0.13489739254297847], [0.03138320738773849, 0.1356732460266264], [0.025338700412499623, 0.13683211303254597], [0.03044565900174724, 0.12656001037497], [0.03196969228633077, 0.12857071537195536], [0.03384272483777624, 0.12488887515359369], [0.035593917697732305, 0.1307330167495086], [0.03922640486993698, 0.13446631197394057], [0.03475755837179945, 0.13430419879131988], [0.033097228822137774, 0.1279376341648437], [0.043315275156758086, 0.1252572268621534], [0.044050445625606664, 0.12136165181210609], [0.0396538775977237, 0.11470682651167938], [0.03778497441792218, 0.10626054957651433], [0.035951177867085286, 0.11142777237864282], [0.036415823003184855, 0.11185199927189346], [0.04290019377267213, 0.12229704702911698], [0.03843547732585335, 0.13744165823434087], [0.038451997567257236, 0.14341804462904972], [0.03354328755361574, 0.13488480757666604], [0.031436899611435365, 0.13568654802797234], [0.027680508136058803, 0.1351911355648005], [0.0322835857258379, 0.12466249118254029], [0.03431150000988996, 0.12669932025321506], [0.03637452056814097, 0.12516128826209175], [0.04312322196422209, 0.14707792205491949], [0.04710883890973115, 0.15198708478668868], [0.04274118163699188, 0.1519788346567268], [0.04114899972196797, 0.1468393608883563], [0.05168300411254489, 0.14567476103549812], [0.05221373109941788, 0.1441238524560034], [0.04865765314527129, 0.14805606687687461], [0.04760239447330542, 0.14768120529828313], [-0.07309489450053347, 1.0005319322268313], [-0.0796149540833069, 1.0027465503973345], [-0.08196291023190937, 1.0165588314691818], [-0.10917347797775902, 1.0068576909310594], [-0.08011118927167664, 0.9590146717373204], [-0.05462368483783613, 0.908680989992716], [-0.016256869264781988, 0.8680428475699897], [0.006262374688582173, 0.8468983330803969], [0.004704731476396836, 0.9220666485811858], [0.007700556246383148, 0.9646983711223556], [-0.03194361994572883, 1.026470171276833], [-0.046054335406395315, 1.051653408551229], [-0.07052638207498038, 1.0319055557057848], [-0.0847152065413458, 0.9737221149549612], [-0.07525905775677028, 0.9464036199659841], [-0.056948664662396085, 0.929911969039955], [-0.04364204762005729, 0.9333814972463684], [-0.04367421414895818, 0.9526693677577375], [-0.044198023837766255, 0.9458667962899867], [-0.08919517037672668, 0.9909410101563544], [-0.09967137598392457, 0.9953128507270503], [-0.10468433236157329, 1.0191316851415013], [-0.13151812373280336, 1.0092968236282416], [-0.10221690466980739, 0.9625453851361447], [-0.07510283161436432, 0.9105906682153764], [-0.03607436029465291, 0.8700703323361543], [-0.01336213397183295, 0.8497440587944868], [-0.014919777184018287, 0.9246477252042573], [-0.008018348302294757, 0.9704643974814626], [-0.04030161112113374, 1.0261579696473173], [-0.054329619741926356, 1.0512019002502835], [-0.07839732186001694, 1.0305380941163593], [-0.09342699984072483, 0.9715110342797585], [-0.08745373029197598, 0.9406802632084184], [-0.06867925967250404, 0.9212147085271307], [-0.05537264263016525, 0.9248871240337184], [-0.05540480915906614, 0.9443481009871656], [-0.05377364503059151, 0.9419947938944694], [-0.03826911023874157, 0.7549851687433771], [-0.008480842171060243, 0.7208819663339231], [-0.036302528143378684, 0.781093225947047], [-0.01609447646629194, 0.794964096397448], [-0.03386267526717535, 0.7740345803855806], [-0.03732717143179014, 0.7594812507252817], [-0.09633394565979211, 0.7553443217205202], [-0.06073781976412083, 0.8155174318588356], [-0.08159373977606924, 0.8059229957395003], [-0.06663298190988858, 0.8040698324089587], [-0.12901695393997342, 0.8059874934327502], [-0.14327929974613904, 0.8364286777101857], [-0.12888370504088956, 0.8369759438485228], [-0.14962016486920063, 0.7805876433469197], [-0.10537656590920584, 0.7531549568233713], [-0.11108793507346176, 0.7977541619534462], [-0.1311627411713085, 0.8302690096471345], [-0.09776293545567977, 0.7742682208922977], [-0.0564738185333634, 0.7429230228214114], [-0.058569059761417706, 0.7281423634544275], [-0.013902738668297514, 0.7192261038717328], [-0.03538356267782892, 0.7809447409164737], [-0.012418614347176305, 0.7950256865912108], [-0.025486304537104123, 0.7753495381028173], [-0.028799171366825187, 0.7607844780284637], [-0.08402899733808791, 0.7545751588437346], [-0.05130004368979355, 0.8177426449338826], [-0.06615971485634559, 0.816602743682046], [-0.053087431118534555, 0.8150744328439169], [-0.1154714031486194, 0.818008937524876], [-0.1479660241406989, 0.8382335067077026], [-0.12660926527440033, 0.8349415227644814], [-0.1438260872713852, 0.7736199201649342], [-0.09502441938645367, 0.7357997036608515], [-0.09937571948956184, 0.7780941414230211], [-0.12038327507666666, 0.8124672054130296], [-0.08832056494228992, 0.7561575566890418], [-0.05365718871250685, 0.7386708135842931], [-0.06618160362644442, 3.4073266009917016], [-0.04945643914156947, 3.433944190400161], [-0.028356994213215237, 3.50396811149851], [0.0135018824246423, 3.4825500677724586], [0.05465316102872121, 3.4599623077379866], [0.028935894241620755, 3.4347836331804347], [-0.0667467811626607, 3.395804083475718], [-0.1664131830671224, 3.3758605676591986], [-0.20403104254991972, 3.318301804948814], [-0.1303208159475491, 3.3519507926717766], [-0.12391104372765202, 3.4017989887036997], [-0.1077510143935295, 3.412230017584583], [-0.06993101026605943, 3.386434643939067], [-0.029965198807546806, 3.440439834473596], [-0.05812689238067331, 3.457017066308874], [-0.04472375314297347, 3.4589573412948056], [-0.07704380440429368, 3.415970225040741], [-0.0523695618652835, 3.3766520997377407], [-0.03529058780585383, 3.364757542961064], [0.011277998893939215, 3.375916740087749], [0.03255663760777178, 3.4068958746410827], [0.059610981173042595, 3.483725775166637], [0.10116659759961326, 3.475713828451839], [0.13721761773822122, 3.4596793314832017], [0.11150035095112078, 3.4351221381961334], [0.004872795258616579, 3.3910380968263816], [-0.10356513099295311, 3.3647692737284136], [-0.17283675747779037, 3.3219260125884107], [-0.11028277231701489, 3.356866662767711], [-0.1074110177400269, 3.404762523138225], [-0.10553171277720609, 3.4120782594795895], [-0.08144564827069126, 3.3932803885699028], [-0.04921752681698779, 3.4565588221919348], [-0.07580319239661612, 3.47553275594519], [-0.05922043310671017, 3.4768527325859147], [-0.08733162364183829, 3.430318243007826], [-0.059408837527935875, 3.387040199771403], [-0.0405240975930516, 3.372703186546062]], [[-0.5276005611160834, 0.4070365862362914], [-0.5185554866590698, 0.4130494383907038], [-0.5102207931360744, 0.4117150160518309], [-0.49303308225654324, 0.40962397663581496], [-0.4893861387310357, 0.41283855730636443], [-0.48921061100052865, 0.4137499417326746], [-0.4904517312504046, 0.4065852659511684], [-0.489388205650953, 0.4049840012384183], [-0.4825507061975478, 0.41303934101372364], [-0.4757338573168642, 0.4216783073666586], [-0.4780095825132368, 0.4248831615191206], [-0.4831826200002226, 0.44150179826896563], [-0.4836307470526161, 0.43467232933972005], [-0.5060575836305988, 0.43181123001367916], [-0.5050415603568424, 0.44113198886985744], [-0.5138119827024639, 0.4281028063206965], [-0.5222106884817738, 0.4289657139848241], [-0.5297048828907809, 0.4237983397470686], [-0.5366373808907972, 0.4047644553924374], [-0.5219153783781904, 0.4060948894943243], [-0.511494956545307, 0.4103462039962705], [-0.5023404242559175, 0.4067767838696382], [-0.4852497726036557, 0.4042798161339217], [-0.4806012621727483, 0.40513005917743333], [-0.4794778602743714, 0.4038702329828719], [-0.48090690343564474, 0.396491524741211], [-0.48155739880367665, 0.3968940567687774], [-0.47636783829235857, 0.408162609352698], [-0.46955098941167495, 0.41680065378641235], [-0.4702696396070051, 0.4205228337644937], [-0.47325575081952687, 0.43753981275952775], [-0.4726444886483509, 0.43179350496137975], [-0.4950713252263336, 0.42949225189111107], [-0.4955834653609882, 0.4410944267714485], [-0.5053492592936702, 0.427100648321552], [-0.5140825090518398, 0.4277975031888968], [-0.5215663783691807, 0.4200695534110292], [-0.5289511302082622, 0.40070785070521103], [0.09489714819335796, 0.6517614021111047], [0.09549602352339646, 0.6426272074147495], [0.08228773084180109, 0.6539151131742779], [0.0838138365557072, 0.6681438787602835], [0.09071535302390313, 0.6777818373636483], [0.10216832332762665, 0.657166846997808], [0.12357913377064537, 0.6135834622276883], [0.12745116947534652, 0.6209984516977763], [0.11438123827843058, 0.6217777569314111], [0.09644389798130101, 0.6561111734261333], [0.11081070219094319, 0.6504254919034504], [0.0926234944530859, 0.6694022281118104], [0.08275650768412342, 0.6703407595449767], [0.0802660164712318, 0.6569806294716853], [0.06261572257840428, 0.6559416531524337], [0.06371021896785382, 0.647215612865673], [0.07537795803665208, 0.6249008921563063], [0.07328189093748043, 0.6203865537110853], [0.07451681493669106, 0.6493435349585374], [0.08494756309163018, 0.6403736870461988], [0.08624856790591931, 0.6313094623799641], [0.07268508009869477, 0.6412159725510476], [0.07519416711624342, 0.6573782042218603], [0.08209568358443935, 0.6672616367587761], [0.09354865388816287, 0.6464652319676811], [0.11471991403457901, 0.6023683335646444], [0.12026673466475743, 0.6153678046856021], [0.10947046323561718, 0.6201986995545724], [0.09019081670377435, 0.6557678339320459], [0.10204647632982132, 0.6526412093410608], [0.09841606086762301, 0.6555216315693128], [0.08854907409866052, 0.6565678218714187], [0.08605858288576891, 0.6429441825500575], [0.07032468879659629, 0.6409396139271385], [0.06730966407861881, 0.6430601099890361], [0.07613997490236592, 0.6243731973679756], [0.07275116385827804, 0.6206570189589123], [0.07335004123361331, 0.6495313031658262], [0.8920161482669284, 0.28211474521315744], [0.8877558696629673, 0.2926587021904712], [0.8827129295095801, 0.2851328027958405], [0.8831755124225185, 0.2836854719062257], [0.8895215217088317, 0.2799985133479657], [0.8880924815633173, 0.2834950310659159], [0.8871714497177765, 0.2792812387129175], [0.8969806149312906, 0.2832145728593806], [0.8883609489280859, 0.28431932456227493], [0.8883506157636193, 0.28381480638490436], [0.8934080181322221, 0.2852667597609049], [0.8979615350414453, 0.2823139884554696], [0.8960864329389457, 0.285672955091061], [0.8967926896594721, 0.2895521507842965], [0.8959790423255543, 0.2918960534747806], [0.896726606413722, 0.2879574159671331], [0.8990188507877034, 0.28016841378100926], [0.8923135151572782, 0.27861673076834387], [0.8943620839091981, 0.27565797732142383], [0.8980482647211516, 0.27514911736788733], [0.8947689021969664, 0.28330654750569784], [0.8898849736834908, 0.2751916432196019], [0.8901431136925159, 0.2736680732727168], [0.8967637794477672, 0.26882778589057055], [0.8953574548379101, 0.27250596671838995], [0.8945025061096611, 0.26854216208020965], [0.905249220527837, 0.2725997649860132], [0.8973378784280142, 0.27252040895152646], [0.8974597105668087, 0.2740400856095242], [0.9014184869954298, 0.2784578798047154], [0.9009744953685279, 0.28285478425548355], [0.8963445688373056, 0.2856134481080218], [0.8970508255578321, 0.28949280595978194], [0.8961690305892763, 0.2918558795937046], [0.8966006366214876, 0.2879765884438074], [0.8999274891704835, 0.28030504146087454], [0.8921813500788192, 0.27854547850978445], [0.8930755351220483, 0.2748335906418016], [0.016711006832212723, 1.0752659770765418], [0.022950788804305847, 1.0118960554214096], [0.020501741681826013, 1.0313665126168683], [-0.020796570216369784, 0.9965756846296531], [0.0231391667019062, 0.9292695994260919], [-0.008882184801944372, 0.990921631310121], [-0.01281536241656105, 0.9924508590819083], [-0.03105681937525113, 1.0064546594341681], [-0.01766749343770588, 1.002057744702117], [-0.03701172464784106, 1.0932947463649778], [-0.05634216487744887, 1.0855797649118364], [-0.052817929512018275, 1.1062507452660066], [-0.07162915274565076, 1.110673349055011], [-0.05557023140537585, 1.043818121418047], [-0.004172490510270642, 1.022185605894996], [-0.02512490875408824, 1.080722089588968], [-0.023581039437478215, 1.0492039627593277], [-0.003878415144723037, 1.063234282569171], [-0.0011904416605830193, 1.1099595567328882], [0.019449524252257985, 1.0745305846541708], [0.030389814305416277, 1.0083226335878155], [0.03422189631563579, 1.0211578550993676], [-0.007076415582560003, 0.9865863720814497], [0.03685932133571598, 0.9178864140095616], [0.00015584090403441726, 0.9834581805707021], [-0.007917276740170502, 0.9876137959279969], [-0.02615873369886058, 1.0017751913637105], [-0.013224295509079921, 0.9976174369165325], [-0.032913138680481194, 1.0895407283866727], [-0.05897500069314164, 1.0869926661595088], [-0.05553347216758492, 1.1076775571863837], [-0.07537853154193225, 1.1123655008941535], [-0.04868717977359634, 1.0444944592296415], [0.005426104290908652, 1.0241393275589137], [-0.01786967557212659, 1.0832883923517496], [-0.012865901013418776, 1.0551293651242057], [0.0033768180372386143, 1.0656967994409121], [0.007470808826900762, 1.1121081543359277], [-0.03826911093924066, 0.7383118311508723], [-0.06285143550485373, 0.7298740749488575], [-0.07973283288823761, 0.6861463142788039], [-0.04397128407185062, 0.6256537903226601], [-0.023248613994680988, 0.6140289231925524], [0.017810765453132576, 0.6048489473236781], [0.06890065309687934, 0.6190152956472715], [0.0930648489919459, 0.639548666486684], [0.12666222495468463, 0.6631755904964971], [0.18461219088680209, 0.7323259143089899], [0.19534570824732234, 0.7488434498475159], [0.1608201719816485, 0.7260606202891575], [0.15959335506114916, 0.7507836383517501], [0.127572003187981, 0.7264563316118228], [0.07952388968511388, 0.7373131203429122], [0.054978320059960645, 0.7363953571969403], [0.013951106896174365, 0.7296204279082861], [-0.021084453685787218, 0.7348747748194258], [-0.048639634704410004, 0.7548856090340343], [-0.03377996450932375, 0.7385736830754782], [-0.059621271677315235, 0.7305029554175774], [-0.0781614018387386, 0.686290542366264], [-0.04515674967591747, 0.6252944582345937], [-0.027576941697745872, 0.6115274467552682], [0.01570173962330767, 0.6033077187558634], [0.06679162726705444, 0.6176854089046185], [0.09004604715275867, 0.6375667761687296], [0.11404942410219268, 0.6530082786269792], [0.17199939003431014, 0.7241503484464862], [0.1827329073948304, 0.7410344854525248], [0.16786863767855062, 0.7212202683945916], [0.16664182075805128, 0.7461153848868349], [0.13503400346962735, 0.7219286049984154], [0.08996333825755222, 0.7342163064161269], [0.06244032034160698, 0.7326752623173735], [0.019924382518591553, 0.7253483477381505], [-0.013774082482118031, 0.7292440881493764], [-0.04198172908469007, 0.7498068294156478], [-0.20576330447762176, 3.2717164160009116], [-0.18420896386920377, 3.3096554934415288], [-0.13706142798965348, 3.34181772019049], [-0.08215783626354974, 3.2996032278434813], [-0.049107245057178985, 3.2866294609996434], [0.008828935181272441, 3.247544139841454], [-0.005336896548497266, 3.2021143732710597], [-0.026790153588457353, 3.249386888596452], [-0.018937594739013706, 3.260632396887698], [0.004564948034761795, 3.303240954598551], [0.09236752081277042, 3.366030625813723], [0.08920167367263086, 3.3529979894615067], [0.1447301690530931, 3.3456044686512896], [0.09789048671995386, 3.316159067824426], [0.07023881529939585, 3.319386203285218], [-0.02810887706562363, 3.3128035673636673], [-0.10785211301569281, 3.2758379660713137], [-0.1632933078076819, 3.340450896684116], [-0.22746925890959543, 3.287779073615619], [-0.2491017173461873, 3.260800998202131], [-0.22582891214125114, 3.2915809316309113], [-0.1815853089029933, 3.3162166885147766], [-0.12386968218047044, 3.266839766683543], [-0.08708349613729736, 3.25455634183128], [-0.022645634566915446, 3.2175464904241533], [-0.014705749870888117, 3.192165648608123], [-0.019190310629020477, 3.2573613656547917], [0.003990595903376053, 3.284241377277216], [0.02874752664777996, 3.32710769464249], [0.12008811706869767, 3.390438616989079], [0.12268418336993661, 3.369344429380965], [0.1769307202916464, 3.335543854106793], [0.11035625556692609, 3.3032429902276568], [0.07887249465646415, 3.308176110404881], [-0.017591318918456292, 3.298348444089883], [-0.09496362186197577, 3.2576791698703387], [-0.15040481665396485, 3.3228621579479625], [-0.21037190497435374, 3.2656669096811894]]]

var gyoZ = [];
var ggyoZ=[];
var label = [];

function mid5(arr) {
  var i;
  var output = [];
  arr.unshift(0, 0);
  arr.push(0, 0);
  for (i = 2; i < arr.length-2; i++) {
    var temp = arr.slice(i - 2, i + 3).sort(function(a, b) {
      return a - b
    })[2];
    output.push(temp);
  }
  return output
}

function calculate_probability(x, mean, stdev) {
  var exponent = Math.exp(-((x - mean) * (x - mean) / (2 * stdev * stdev)));
  return (1 / (Math.sqrt(2 * 3.14159265) * stdev)) * exponent;
}

function predict(summaries, row) {
  var i;
  var j;
  var probability = 0;
  var max_pro = 0;
  var label;
  for (i = 0; i < 4; i++) {
    probability = 0.25
    // console.log(probability)
    for (j = 0; j < 228; j++) {
      // console.log(calculate_probability(row[j], summaries[i][j][0], summaries[i][j][1]));
      probability = probability * calculate_probability(row[j], summaries[i][j][0], summaries[i][j][1]);
    }
    // console.log(probability , max_pro)
    if (probability > max_pro) {
      max_pro = probability
      label = i
    }
  }
  // console.log(label)
  return label
}

function findpeak5(arr) {
  var i;
  var j;
  j = 0;
  for (i = 2; i < arr.length-2; i++) {
    if (
      arr[i - 2] < arr[i - 1] &&
      arr[i - 1] < arr[i] &&
      arr[i] >= arr[i + 1] 
      &&arr[i + 1] >= arr[i + 2]
    ) {
      j++
    }
  }
  return j
}
function findpeakd(arr) {
  var i;
  var j;
  j = 0;
  for (i = 2; i < arr.length-2; i++) {
    if (
      arr[i - 2] <= arr[i - 1] &&
      arr[i - 1] <= arr[i] &&
      arr[i] > arr[i + 1] 
      &&arr[i + 1] > arr[i + 2]
    ) {
      j++
    }
  }
  return j
}
function findpeakk(arr) {
  var i;
  var j;
  j = 0;
  for (i = 3; i < arr.length - 3; i++) {
    if (
      arr[i - 2] <= arr[i - 1] &&
      arr[i - 1] <= arr[i] &&
      arr[i] > arr[i + 1]
      && arr[i + 1] > arr[i + 2]
    ) {
      j++
    }
  }
  return j
}
function filter(arr) {
  var i;
  for (i = 2; i < arr.length - 2; i++) {
    if (
      arr[i] ==1 &&
      arr[i+2] != 1
      && arr[i-1] != 1
    ) {
      arr[i]=arr[i+2]
      console.log(arr[i])
    }
  }
  return arr
}


Page({
  data: {

    orz: 0,
    jump: 0,
    step: 0,
    chest: 0


  },


  onLoad: function(options) {

    this.innerAudioContext0 = wx.createInnerAudioContext()
    this.innerAudioContext0.src = '/speech/huan.wav'

    this.innerAudioContext1 = wx.createInnerAudioContext()
    this.innerAudioContext1.src = '/speech/kai.wav'

    this.innerAudioContext2 = wx.createInnerAudioContext()
    this.innerAudioContext2.src = '/speech/ta.wav'

    // const innerAudioContext3 = wx.createInnerAudioContext()
    this.innerAudioContext3 = wx.createInnerAudioContext()
    this.innerAudioContext3.src = '/speech/xiong.wav'

    this.innerAudioContext4 = wx.createInnerAudioContext()
    this.innerAudioContext4.src = '/speech/start.wav'

    this.innerAudioContext5 = wx.createInnerAudioContext()
    this.innerAudioContext5.src = '/speech/finish.wav'
  },


  waitstart: function() {
    that = this
    gyoZ = [];
    label = [];
    that.innerAudioContext4.play();
    setTimeout(function() {
      console.log('start');
      // that = this
      var i;
      var j;
      var k;
      var yold = 5;
      var timestart;
      var timeend;
      let accX = [];
      let accY = [];
      let accZ = [];
      let geoX = [];
      let geoY = [];
      let geoZ = [];
      // let timeA = [];
      // let timeG = [];

      i = 0;
      j = 0;
      k = 0;

      wx.startAccelerometer({
        interval: 'ui',
        success: function(res) {
          console.log('seccess')
        },
        fail: function(res) {
          console.log('fail')
        }
      })
      wx.startGyroscope({
        interval: 'ui',
      })
      wx.vibrateLong();
      wx.showToast({
        title: '开始识别',
        icon: 'none',

      })
      // console.log(that.data.inputTime);
      timestart = (new Date()).valueOf()
      timeend = timestart + 31000
      // console.log(timeend);

      wx.onGyroscopeChange(function(res) {

        var now = (new Date()).valueOf()

        if (now >= timeend) {
          wx.offGyroscopeChange()
          wx.stopGyroscope()
          // loaded = 0;
          if (i == 0) {
            i = 1;
            wx.vibrateLong();
            console.log('over', accX, geoZ);
            // that.setData({
            //   left: timeG.length
            // })
            wx.showToast({
              title: '结束识别',
              icon: 'none',

            })
            that.innerAudioContext5.play();
          }
          // that.data.geoX = geoX;
          // that.data.geoY = geoY;
          ggyoZ = mid5(geoZ);

          // console.log(label)
          gyoZ.push(mid5(geoZ.slice(-42)))
          label[1] = label[2]
          label[0] = label[1]

          label.push(label[label.length - 1])
          // that.data.timeG = timeG;
          // return
        }

        if (now < timeend) {
          // console.log('g', geoX)
          // timeG.push(now)
          geoX.push(res.x)
          geoY.push(res.y)
          geoZ.push(res.z)
        }

      })



      wx.onAccelerometerChange(function(res) {

        var now = (new Date()).valueOf()

        if (now >= timeend) {
          wx.offAccelerometerChange()
          wx.stopAccelerometer()
          
        }

        if (now < timeend) {
          // console.log('a',now)
          // timeA.push(now)
          accX.push(res.x)
          accY.push(res.y)
          accZ.push(res.z)
          if (accX.length >= 38&&k==0) {
            k = 1
          }
          // var now = (new Date()).valueOf()
          if (k == 1) {
            if (now - 2000 >= timestart + j * 1000) {
              // var gX = mid5(geoX.slice(-38));
              // var gZ = mid5(geoZ.slice(-38));
              // var aY = mid5(accY.slice(-38))

              var x = mid5(accX.slice(-38));
              x.push.apply(x, mid5(accY.slice(-38)));
              x.push.apply(x, mid5(accZ.slice(-38)));
              x.push.apply(x, mid5(geoX.slice(-38)));
              x.push.apply(x, mid5(geoY.slice(-38)));
              x.push.apply(x, mid5(geoZ.slice(-38)));
              // console.log(accX);
              j++;
              var y = predict(summarize, x)
              if (y != yold) {
                switch (y) {
                  case 0:
                    that.innerAudioContext0.play();
                    break;
                  case 1:
                    that.innerAudioContext1.play();
                    break;
                  case 2:
                    that.innerAudioContext2.play();
                    break;
                  case 3:
                    that.innerAudioContext3.play();
                    break;
                }
              }
              yold = y;
              gyoZ.push(mid5(geoZ.slice(-36)))
              label.push(y)
              console.log(y)


            }
          }
        }

      })


    }, 800)
  },


  upload: function() {
    that = this
    var i;
    var orz = 0;
    var jump = 0;
    var step = 0;
    var chest = 0;
    label=filter(label)
    console.log(label, gyoZ)
    for (i = 0; i < label.length; i++) {
      switch (label[i]) {
        case 0:
          orz = orz + findpeakd(gyoZ[i]);
          break;
        case 1:
          // if (i != label.length){
          // jump = jump + Math.min(2,findpeak5(gyoZ[i]));}else{
            jump = jump + findpeakk(gyoZ[i])
          // }
          break;
        case 2:
          step = step + findpeak5(gyoZ[i]);
          break;
        case 3:
          chest = chest + findpeakd(gyoZ[i]);
          break;

      }
    }
    // orz = Math.ceil(orz / 2);
    // jump = Math.ceil(jump/ 2);
    // step = Math.ceil(step  / 2);
    // chest = Math.ceil(chest/ 2);
    orz = parseInt(orz / 2);
    jump = parseInt(jump/ 2);
    step = parseInt(step / 2);
    chest = parseInt(chest/ 2);

    // jump = findpeakd(ggyoZ);
    this.setData({
      orz: orz,
      jump: jump,
      step: step,
      chest: chest
    })


    db.collection('HARresult').add({
          data: {
            orz: orz,
            jump: jump,
            step: step,
            chest: chest
          }

        })
        .then(res => {
          wx.showToast({
        title: '上传完成',

      })

        })
    

  },

  // onPullDownRefresh: function() {
  //   wx.reLaunch({
  //     url: 'index'
  //   })
  // },
  clear: function() {

    gyoZ = [];
    label = [];
    wx.reLaunch({
      url: 'index'
    })
  },
  sample: function(){
    wx.navigateTo({
      url: '/pages/sample/sample',
    })
  }

})